# getSVGSize Demo åŒå‘ä¼ å€¼å†…å®¹æ€»ç»“

## ğŸ“¤ JavaScript â†’ C++ ä¼ å€¼

### å‚æ•° 1: `tag` (number)

**JavaScript ç«¯**:
```typescript
const svgTag = 1;  // number ç±»å‹
```

**C++ ç«¯æ¥æ”¶**:
```cpp
int32_t tagValue = *tag;  // number â†’ int32_t
```

**ç”¨é€”**: æ ‡è¯† SVG ç»„ä»¶çš„å”¯ä¸€ ID

---

### å‚æ•° 2: `options` (object)

**JavaScript ç«¯ä¼ é€’**:
```typescript
const options = {
  // 1. å­—ç¬¦ä¸²ç±»å‹ (string)
  unit: 'px',
  
  // 2. æ•°å­—ç±»å‹ (number)
  scale: 1.5,
  
  // 3. å¸ƒå°”ç±»å‹ (boolean)
  includeAspectRatio: true,
  
  // 4. æ•°ç»„ç±»å‹ (array)
  extraInfo: ['info1', 'info2', 'info3'],
  
  // 5. åµŒå¥—å¯¹è±¡ (nested object)
  metadata: {
    source: 'react-native-svg',
    version: '1.0.0'
  }
};
```

**C++ ç«¯è§£æ**:

```cpp
// 1. å­—ç¬¦ä¸² (string â†’ std::string)
std::string unit = opts.getProperty(rt, "unit").asString(rt).utf8(rt);
// ç»“æœ: unit = "px"

// 2. æ•°å­— (number â†’ double)
double scale = opts.getProperty(rt, "scale").asNumber();
// ç»“æœ: scale = 1.5

// 3. å¸ƒå°”å€¼ (boolean â†’ bool)
bool includeAspectRatio = opts.getProperty(rt, "includeAspectRatio").getBool();
// ç»“æœ: includeAspectRatio = true

// 4. æ•°ç»„ (array â†’ std::vector<std::string>)
jsi::Array infoArray = opts.getProperty(rt, "extraInfo").getObject(rt).getArray(rt);
for (size_t i = 0; i < infoArray.length(rt); i++) {
    std::string item = infoArray.getValueAtIndex(rt, i).asString(rt).utf8(rt);
    extraInfo.push_back(item);
}
// ç»“æœ: extraInfo = ["info1", "info2", "info3"]

// 5. åµŒå¥—å¯¹è±¡ (object â†’ jsi::Object)
jsi::Object metadata = opts.getProperty(rt, "metadata").getObject(rt);
std::string source = metadata.getProperty(rt, "source").asString(rt).utf8(rt);
// ç»“æœ: source = "react-native-svg"
```

---

## ğŸ“¥ C++ â†’ JavaScript ä¼ å€¼

### è¿”å›å¯¹è±¡ç»“æ„

**C++ ç«¯åˆ›å»º**:
```cpp
jsi::Object result(rt);

// 1. åŸºæœ¬ç±»å‹ï¼šnumber (double â†’ number)
result.setProperty(rt, "width", jsi::Value(width));      // ä¾‹å¦‚: 150.0
result.setProperty(rt, "height", jsi::Value(height));    // ä¾‹å¦‚: 150.0

// 2. åŸºæœ¬ç±»å‹ï¼šboolean (bool â†’ boolean)
result.setProperty(rt, "success", jsi::Value(true));

// 3. åŸºæœ¬ç±»å‹ï¼šstring (std::string â†’ string)
result.setProperty(rt, "sizeString", jsi::String::createFromUtf8(rt, "150x150px"));

// 4. null å€¼
result.setProperty(rt, "error", jsi::Value::null());

// 5. åµŒå¥—å¯¹è±¡ (jsi::Object â†’ nested object)
jsi::Object sizeInfo(rt);
sizeInfo.setProperty(rt, "width", jsi::Value(width));
sizeInfo.setProperty(rt, "height", jsi::Value(height));
sizeInfo.setProperty(rt, "unit", jsi::String::createFromUtf8(rt, unit));
sizeInfo.setProperty(rt, "aspectRatio", jsi::Value(aspectRatio));
result.setProperty(rt, "sizeInfo", jsi::Value(rt, sizeInfo));

// 6. æ•°ç»„ (jsi::Array â†’ array)
jsi::Array dimensions(rt, 2);
dimensions.setValueAtIndex(rt, 0, jsi::Value(width));
dimensions.setValueAtIndex(rt, 1, jsi::Value(height));
result.setProperty(rt, "dimensions", jsi::Value(rt, dimensions));

// 7. å›æ˜¾æ•°ç»„ï¼ˆå°† JS ä¼ æ¥çš„æ•°ç»„åŸæ ·è¿”å›ï¼‰
jsi::Array receivedInfo(rt, extraInfo.size());
for (size_t i = 0; i < extraInfo.size(); i++) {
    receivedInfo.setValueAtIndex(rt, i, jsi::String::createFromUtf8(rt, extraInfo[i]));
}
result.setProperty(rt, "receivedExtraInfo", jsi::Value(rt, receivedInfo));

// 8. å…ƒæ•°æ®å¯¹è±¡ï¼ˆåŒ…å«å¤šç§ç±»å‹ï¼‰
jsi::Object metadata(rt);
metadata.setProperty(rt, "tag", jsi::Value(tagValue));
metadata.setProperty(rt, "scale", jsi::Value(scale));
metadata.setProperty(rt, "unit", jsi::String::createFromUtf8(rt, unit));
metadata.setProperty(rt, "timestamp", jsi::Value((double)time(nullptr)));
result.setProperty(rt, "metadata", jsi::Value(rt, metadata));
```

**JavaScript ç«¯æ¥æ”¶**:
```typescript
const result = {
  // 1. number ç±»å‹
  width: 150,
  height: 150,
  
  // 2. boolean ç±»å‹
  success: true,
  
  // 3. string ç±»å‹
  sizeString: "150x150px",
  
  // 4. null å€¼
  error: null,
  
  // 5. åµŒå¥—å¯¹è±¡
  sizeInfo: {
    width: 150,
    height: 150,
    unit: "px",
    aspectRatio: 1.0
  },
  
  // 6. æ•°ç»„
  dimensions: [150, 150],
  
  // 7. å›æ˜¾æ•°ç»„ï¼ˆä» JS ä¼ æ¥çš„ extraInfoï¼‰
  receivedExtraInfo: ["info1", "info2", "info3"],
  
  // 8. å…ƒæ•°æ®å¯¹è±¡
  metadata: {
    tag: 1,
    scale: 1.5,
    unit: "px",
    timestamp: 1703001234.567
  }
};
```

---

## ğŸ“Š å®Œæ•´ä¼ å€¼å¯¹ç…§è¡¨

### JavaScript â†’ C++

| JavaScript | C++ | è½¬æ¢æ–¹æ³• | ç¤ºä¾‹å€¼ |
|------------|-----|----------|--------|
| `tag: 1` (number) | `int32_t tagValue` | `args[0].asNumber()` | `1` |
| `unit: 'px'` (string) | `std::string unit` | `.asString(rt).utf8(rt)` | `"px"` |
| `scale: 1.5` (number) | `double scale` | `.asNumber()` | `1.5` |
| `includeAspectRatio: true` (boolean) | `bool includeAspectRatio` | `.getBool()` | `true` |
| `extraInfo: ['info1', 'info2']` (array) | `std::vector<std::string>` | `.getObject(rt).getArray(rt)` | `["info1", "info2"]` |
| `metadata: { source: '...' }` (object) | `jsi::Object metadata` | `.getObject(rt)` | `{ source: "react-native-svg" }` |

### C++ â†’ JavaScript

| C++ | JavaScript | è½¬æ¢æ–¹æ³• | ç¤ºä¾‹å€¼ |
|-----|------------|----------|--------|
| `double width = 150.0` | `width: 150` (number) | `jsi::Value(width)` | `150` |
| `bool success = true` | `success: true` (boolean) | `jsi::Value(true)` | `true` |
| `std::string sizeStr = "150x150px"` | `sizeString: "150x150px"` (string) | `jsi::String::createFromUtf8(rt, sizeStr)` | `"150x150px"` |
| `nullptr` | `error: null` (null) | `jsi::Value::null()` | `null` |
| `jsi::Object sizeInfo` | `sizeInfo: { ... }` (nested object) | `jsi::Value(rt, sizeInfo)` | `{ width: 150, height: 150 }` |
| `jsi::Array dimensions` | `dimensions: [150, 150]` (array) | `jsi::Value(rt, dimensions)` | `[150, 150]` |

---

## ğŸ”„ å®Œæ•´è°ƒç”¨ç¤ºä¾‹

### JavaScript è°ƒç”¨

```typescript
// JavaScript â†’ C++ ä¼ å€¼
const tag = 1;
const options = {
  unit: 'px',                    // string â†’ C++
  scale: 1.5,                    // number â†’ C++
  includeAspectRatio: true,      // boolean â†’ C++
  extraInfo: ['info1', 'info2'], // array â†’ C++
  metadata: {                    // nested object â†’ C++
    source: 'react-native-svg',
    version: '1.0.0'
  }
};

// è°ƒç”¨ JSI æ¥å£
const result = RNSVGSvgViewModule.getSVGSize(tag, options);

// C++ â†’ JavaScript ä¼ å€¼æ¥æ”¶
console.log(result.width);              // 150 (number)
console.log(result.height);             // 150 (number)
console.log(result.success);           // true (boolean)
console.log(result.sizeString);        // "150x150px" (string)
console.log(result.error);             // null
console.log(result.sizeInfo);          // { width: 150, height: 150, unit: "px" } (nested object)
console.log(result.dimensions);        // [150, 150] (array)
console.log(result.receivedExtraInfo); // ["info1", "info2"] (array echo)
console.log(result.metadata);          // { tag: 1, scale: 1.5, unit: "px", timestamp: ... } (object)
```

---

## ğŸ“ ä¼ å€¼æµç¨‹å›¾

```
JavaScript è°ƒç”¨
    â†“
å‚æ•° 1: tag = 1 (number)
å‚æ•° 2: options = {
  unit: 'px',                    â† string
  scale: 1.5,                    â† number
  includeAspectRatio: true,      â† boolean
  extraInfo: ['info1', 'info2'],  â† array
  metadata: { ... }              â† nested object
}
    â†“
ã€JavaScript â†’ C++ ä¼ å€¼ã€‘
    â†“
C++ è§£æ:
  - tag â†’ int32_t (1)
  - unit â†’ std::string ("px")
  - scale â†’ double (1.5)
  - includeAspectRatio â†’ bool (true)
  - extraInfo â†’ std::vector (["info1", "info2"])
  - metadata â†’ jsi::Object ({ source: "react-native-svg" })
    â†“
C++ ä¸šåŠ¡é€»è¾‘:
  - è·å– SVG å°ºå¯¸
  - åº”ç”¨ scale
  - è®¡ç®— aspectRatio
    â†“
ã€C++ â†’ JavaScript ä¼ å€¼ã€‘
    â†“
C++ åˆ›å»ºè¿”å›å¯¹è±¡:
  - width: 150 (number)
  - height: 150 (number)
  - success: true (boolean)
  - sizeString: "150x150px" (string)
  - error: null
  - sizeInfo: { ... } (nested object)
  - dimensions: [150, 150] (array)
  - receivedExtraInfo: ["info1", "info2"] (array echo)
  - metadata: { ... } (object)
    â†“
JavaScript æ¥æ”¶ç»“æœ
```

---

## ğŸ¯ å…³é”®ç‚¹æ€»ç»“

### JavaScript â†’ C++ ä¼ å€¼

1. **åŸºæœ¬ç±»å‹**: number, string, boolean
2. **å¤åˆç±»å‹**: array, object, nested object
3. **æ‰€æœ‰å€¼éƒ½é€šè¿‡ `options` å¯¹è±¡ä¼ é€’**ï¼ˆé™¤äº† tagï¼‰

### C++ â†’ JavaScript ä¼ å€¼

1. **åŸºæœ¬ç±»å‹**: number (width, height), boolean (success), string (sizeString), null (error)
2. **å¤åˆç±»å‹**: 
   - åµŒå¥—å¯¹è±¡ (sizeInfo)
   - æ•°ç»„ (dimensions, receivedExtraInfo)
   - å¯¹è±¡ (metadata)
3. **å›æ˜¾æœºåˆ¶**: `receivedExtraInfo` å°† JS ä¼ æ¥çš„ `extraInfo` åŸæ ·è¿”å›

---

## ğŸ’¡ å®é™…åº”ç”¨

### ä½¿ç”¨åœºæ™¯

- **unit**: æ§åˆ¶è¿”å›å€¼çš„å•ä½ï¼ˆpx, pt, em ç­‰ï¼‰
- **scale**: ç¼©æ”¾ SVG å°ºå¯¸
- **includeAspectRatio**: æ˜¯å¦åŒ…å«å®½é«˜æ¯”ä¿¡æ¯
- **extraInfo**: ä¼ é€’é¢å¤–çš„å…ƒä¿¡æ¯ï¼ˆä¼šè¢«å›æ˜¾ï¼‰
- **metadata**: ä¼ é€’åµŒå¥—çš„é…ç½®ä¿¡æ¯

### è¿”å›å€¼ç”¨é€”

- **width/height**: SVG çš„å®é™…å°ºå¯¸
- **sizeString**: æ ¼å¼åŒ–çš„å°ºå¯¸å­—ç¬¦ä¸²ï¼ˆå¦‚ "150x150px"ï¼‰
- **sizeInfo**: åŒ…å«å•ä½ã€å®½é«˜æ¯”ç­‰å®Œæ•´ä¿¡æ¯
- **dimensions**: å°ºå¯¸æ•°ç»„ï¼Œæ–¹ä¾¿ä½¿ç”¨
- **receivedExtraInfo**: éªŒè¯æ•°ç»„ä¼ å€¼æ˜¯å¦æ­£ç¡®
- **metadata**: åŒ…å«è°ƒç”¨æ—¶çš„ä¸Šä¸‹æ–‡ä¿¡æ¯

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0  
**æœ€åæ›´æ–°**: 2024-12-19  
**é€‚ç”¨é¡¹ç›®**: rntpc_ios

